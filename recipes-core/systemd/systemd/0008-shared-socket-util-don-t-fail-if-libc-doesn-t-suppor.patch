From edd8ecb70f0f2d2b6555610453653525956efe97 Mon Sep 17 00:00:00 2001
From: Emil Renner Berthing <systemd@esmil.dk>
Date: Thu, 18 Sep 2014 15:24:45 +0200
Subject: [PATCH 08/17] shared/socket-util: don't fail if libc doesn't support
 IDN

---
 src/shared/socket-util.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/src/shared/socket-util.c b/src/shared/socket-util.c
index a4e26b1..69938b1 100644
--- a/src/shared/socket-util.c
+++ b/src/shared/socket-util.c
@@ -41,6 +41,16 @@
 #include "missing.h"
 #include "fileio.h"
 
+/* Don't fail if the standard library
+ * doesn't support IDN */
+#ifndef NI_IDN
+#define NI_IDN 0
+#endif
+
+#ifndef NI_IDN_USE_STD3_ASCII_RULES
+#define NI_IDN_USE_STD3_ASCII_RULES 0
+#endif
+
 int socket_address_parse(SocketAddress *a, const char *s) {
         char *e, *n;
         unsigned u;
-- 
2.1.4

